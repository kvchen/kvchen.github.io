<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-post-js.698587d68df35250722f.css">@import url(https://fonts.googleapis.com/css?family=Source+Code+Pro);@import url(https://fonts.googleapis.com/css?family=Open+Sans);@import url(https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css);@media print{*{background:transparent!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="#"]:after,a[href^="javascript:"]:after{content:""}blockquote,pre{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}img{max-width:100%!important}@page{margin:.5cm}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}}abbr,acronym,blockquote,code,dir,kbd,listing,plaintext,q,samp,tt,var,xmp{-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}h1,h2,h3,h4,h5,h6{font-family:Source Code Pro,Monaco,Menlo,Consolas,Courier New,monospace;font-weight:400;line-height:1;margin-top:0;text-rendering:optimizeLegibility}h1{font-size:48px;font-size:2.6667rem;margin-bottom:.61875em}@media (max-width:550px){h1{font-size:43px}}h1:before{content:"# ";color:#028090}h2{font-size:36px;font-size:2rem;margin-bottom:.825em}@media (max-width:550px){h2{font-size:28px}}h2:before{content:"## ";color:#028090}h3{font-size:24px;font-size:1.3333333333333333rem;margin-bottom:1.2375em}@media (max-width:550px){h3{font-size:22px}}h3:before{content:"### ";color:#028090}h4{font-size:21px;font-size:1.16667rem;margin-bottom:1.4142857142857141em}@media (max-width:550px){h4{font-size:19px}}h4:before{content:"#### ";color:#028090}h5{font-size:18px;font-size:1rem;margin-bottom:1.65em}@media (max-width:550px){h5{font-size:15px}}h6{font-size:18px;font-size:1rem;margin-bottom:1.65em}@media (max-width:550px){h6{font-size:15px}}p{margin:auto auto 1.5em;font-size:18px}a{color:#028090;line-height:inherit;outline:0;-webkit-transition:color .1s ease-out;-webkit-transition-property:color;-webkit-transition-duration:.1s;-webkit-transition-timing-function:ease-out;-webkit-transition-delay:initial;transition:color .1s ease-out;transition-property:color;transition-duration:.1s;transition-timing-function:ease-out;transition-delay:0s}a:hover{color:#03c3db}p a,p a:visited{line-height:inherit}ol,ul{margin-top:0;margin-bottom:1.5em;list-style-position:inside}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-left:0}em,i{font-style:italic}b,em,i,strong{line-height:inherit}.small,small{font-size:75%;font-weight:400;line-height:1}ins,u{text-decoration:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}blockquote{max-width:100%;border-left:5px solid #e6e6e6;margin:1.5em 0}blockquote,q{quotes:none;font-size:125%}blockquote>p{padding:15px}cite{font-style:normal}*,:after,:before{box-sizing:border-box}html{margin:0;padding:0;font-family:Open Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:100%;line-height:1.65;font-weight:400;overflow-y:scroll;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}@media (max-width:550px){html{font-size:15px}}body{background-color:#fff!important;padding:0;color:#333;min-height:100%;*zoom:1;-webkit-font-smoothing:antialiased;-webkit-hyphens:auto;-ms-hyphens:auto;-o-hyphens:auto;hyphens:auto;word-wrap:break-word}body:after,body:before{content:"";display:table}body:after{clear:both}@media (max-width:550px){body{font-size:15px}}.container{width:90%;max-width:800px;margin:auto}.nav{list-style:none;margin-left:0;margin-bottom:0;padding-left:0;*zoom:1}.nav:after,.nav:before{content:"";display:table}.nav:after{clear:both}.nav>li,.nav>li>a{display:inline-block;zoom:1}embed,img,object,video{display:block;max-width:100%;height:auto}img{-ms-interpolation-mode:bicubic;vertical-align:middle;font-style:italic}a img{border:0}img[height],img[width]{max-width:none}figure>img{display:block}audio,canvas,img,video{vertical-align:middle}.btn,button,input[type=button],input[type=reset],input[type=submit]{display:inline-block;vertical-align:middle;cursor:pointer;white-space:nowrap;margin:0;background-image:none;-webkit-user-drag:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:inherit;line-height:1.65;text-align:center;text-decoration:none;color:#fff;border:1px solid transparent;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;padding:15px 20px}.btn:focus,.btn:hover,button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{background-color:#007568;color:#fff;text-decoration:none;border:1px solid transparent;border-bottom:none}.btn:active,button:active,input[type=button]:active,input[type=reset]:active,input[type=submit]:active{outline:none;background-image:none;box-shadow:inset 0 3px 5px rgba(0,0,0,.15)}.btn::-moz-focus-inner{border:0;padding:0}.btn-primary{background-color:#00a896;border-bottom:#007568}.btn-secondary{border:1px solid #b3b3b3;color:#333}.btn-secondary:focus,.btn-secondary:hover{background-color:#e6e6e6;color:#333;border:1px solid #b3b3b3}input,select,textarea{color:#333}fieldset{border:0;margin:0;padding:0}legend{display:block;width:100%;font-size:150%;line-height:inherit;white-space:normal}label{display:inline-block;margin-bottom:5px;font-weight:700}textarea{height:auto;resize:vertical}input[type=checkbox],input[type=radio]{margin:1px 0 0}input[type=file]{display:block;width:100%}select[multiple],select[size]{height:auto}select optgroup{font-size:inherit;font-style:inherit;font-family:inherit}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}output{display:block}button,input,label,output,select{vertical-align:middle}button,input,select,textarea{line-height:inherit;-webkit-font-smoothing:antialiased}input:focus,textarea:focus{outline:0}input,textarea{display:block;width:100%;max-width:100%;border:1px solid #b3b3b3;border-radius:5px;padding:10px 0;font-size:inherit;font-family:inherit;text-indent:15px;vertical-align:middle;background-image:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;-webkit-transition-property:border-color,box-shadow;-webkit-transition-duration:.15s,.15s;-webkit-transition-timing-function:ease-in-out,ease-in-out;-webkit-transition-delay:initial,initial;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition-property:border-color,box-shadow;transition-duration:.15s,.15s;transition-timing-function:ease-in-out,ease-in-out;transition-delay:initial,initial}input textarea,textarea textarea{height:auto}input:focus,textarea:focus{border-color:#00a896;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Source Code Pro,Monaco,Menlo,Consolas,Courier New,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:50px 0;padding:0}::selection{background:#666;color:#fff;text-shadow:none}.browsehappy{margin:.2em 0;background:#ccc;color:#333;padding:.2em 0}#site-header{text-align:center;padding-top:5em;margin-bottom:5em}@media (max-width:800px){#site-header{padding-top:4em!important;margin-bottom:4em!important}}.blog-title{font-weight:500;letter-spacing:4px}.blog-title:before{content:none}.blog-title a{color:#00a896;text-decoration:none}.blog-title:first-letter{background-color:#00a896;color:#fff;margin-right:2px}.post{margin-bottom:9em}@media (max-width:800px){.post{margin-bottom:7em!important}}.post-header{text-align:left}.post-title{margin-bottom:30px}.pagination{text-align:center;margin:4em 0 9em;color:#b3b3b3}@media (max-width:800px){.pagination{margin:4em 0 6em!important}}#site-footer a,.post-content a{color:#028090;text-decoration:none;font-weight:700}#site-footer a:hover,.post-content a:hover{color:#e6e6e6;border-bottom:1px solid}.m-logo{display:none!important;visibility:hidden}.p-post-title{margin-bottom:50px}.f-1{*zoom:1}.f-1:after,.f-1:before{content:"";display:table}.f-1:after{clear:both}.author{float:left}@media (max-width:550px){.author{float:none!important}.f-post-time{float:inherit!important}}.f-post-time{float:right}@media (max-width:550px){.f-post-time{float:none!important}}.f-2{*zoom:1}.f-2:after,.f-2:before{content:"";display:table}.f-2:after{clear:both}.f-post-tags{float:right}@media (max-width:550px){.f-post-tags{float:none!important}}.share{float:left}@media (max-width:550px){.share{float:none!important;margin-bottom:1.5em}}#comments{margin-top:30px}@media (max-width:550px){#comments{margin-top:1em}}.m-page a{color:#333!important}#site-footer{text-align:center;height:10em}</style><meta name="generator" content="Gatsby 2.1.9"/><title data-react-helmet="true">keff</title><meta data-react-helmet="true" charSet="utf-8"/><link rel="manifest" href="/manifest.webmanifest"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><link as="script" rel="preload" href="/webpack-runtime-5999ca5f73382b369690.js"/><link as="script" rel="preload" href="/app-1443edc735991be4614a.js"/><link as="script" rel="preload" href="/0-0ff5f0f1eb7792733837.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-d1383df754ba37f756dc.js"/><link as="fetch" rel="preload" href="/static/d/217/path---blog-gatsby-8-b-6-de7-6DUJd7GnvlxQe7Oy3AxmZAoOalg.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><header id="site-header"><div class="container"><h1 class="blog-title heading"><a href="/">keff</a></h1><ul class="nav"><li><a href="/">Blog</a></li><li style="margin-left:12px"><a href="/about/">About</a></li></ul></div></header><main class="content" role="main"><div class="container"><div><h1>Gatsby</h1><h2><time>September 23, 2018</time></h2><div><p>There are a lot of static site generators these days. Jekyll seemed to be the most popular back when I was in college, but other systems have since popped up: Hugo is a big one, and Pelican also has a somewhat mature ecosystem. Each generator is always tightly coupled to a particular language: Jekyll uses Ruby, Hugo uses Go, Pelican uses Python.</p>
<p>I've wanted to switch from Jekyll for a while now, mostly because I was never fluent in Ruby and that made writing plugins a huge challenge. I recently saw on HackerNews that <a href="https://www.gatsbyjs.org/blog/2018-09-17-gatsby-v2/" target="_blank" rel="nofollow noopener noreferrer">Gatsby released v2.0.0</a>, and I'd never heard of it. Turns out it uses GraphQL and React (two things I use pretty heavily at work) and makes it super easy to get started. I was able to follow the tutorial and get a site up and running in a matter of minutes.</p>
<p>The cool thing about Gatsby is that the entire Webpack pipeline is included out of the box, so you get nice things like hot-module-reloading while developing, and everything gets minified for the production build.</p>
<h3>Flow Typing</h3>
<p>My team at work uses Flow for static typing JavaScript applications, and I've gotten used to all the benefits that provides: catching errors before they go to production, jump to definition, and remembering what bits of code do what. We also use Relay for GraphQL Javascript apps, which has a compiler that generates Flow types as a part of parsing GraphQL queries.</p>
<p>However, turns out that Gatsby is missing this particular feature, and that means all GraphQL queries are untyped by default. Not good!</p>
<p>Luckily, <a href="https://github.com/apollographql/apollo-cli" target="_blank" rel="nofollow noopener noreferrer">Apollo's CLI</a> allows you to generate Flow definitions from any set of Javascript files, regardless if you're using their ecosystem or not. I chained a couple of commands in my <code class="language-text">package.json</code>:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">rm</span> -f src/codegen/graphql/* <span class="token operator">&amp;&amp;</span> \
    apollo schema:download --endpoint http://localhost:8000/___graphql gatsby-schema.json <span class="token operator">&amp;&amp;</span> \
    apollo codegen:generate --tagName graphql  --target flow --useFlowExactObjects --useFlowReadOnlyTypes --queries <span class="token string">'./src/**/*.js'</span> --schema ./gatsby-schema.json --outputFlat src/codegen/graphql</code></pre></div>
<p>This queries the local GraphiQL instance, dumps the schema to a file, and uses that schema to generate Flow types for all JavaScript files in my <code class="language-text">src</code> directory. I can then import those types from the components that need them:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> type <span class="token punctuation">{</span> PostQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../codegen/graphql/PostQuery'</span><span class="token punctuation">;</span>

type Props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">|</span>
  data<span class="token punctuation">:</span> PostQuery<span class="token punctuation">,</span>
<span class="token operator">|</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span><span class="token operator">&lt;</span>Props<span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I've never actually been excited about a static page generator until now, and I've found it super easy to get things up and running.</p></div></div></div></main></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-js","jsonName":"blog-gatsby-8b6","path":"/blog/gatsby"};window.dataPath="217/path---blog-gatsby-8-b-6-de7-6DUJd7GnvlxQe7Oy3AxmZAoOalg";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-1443edc735991be4614a.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-480757d04fed08f1beea.js"],"component---src-templates-index-js":["/component---src-templates-index-js.698587d68df35250722f.css","/component---src-templates-index-js-a55c72390c97ca08885b.js"],"component---src-templates-post-js":["/component---src-templates-post-js.698587d68df35250722f.css","/component---src-templates-post-js-d1383df754ba37f756dc.js"],"component---src-pages-404-js":["/component---src-pages-404-js.698587d68df35250722f.css","/component---src-pages-404-js-35db2f00649ddf40e0d3.js"],"component---src-pages-about-js":["/component---src-pages-about-js.698587d68df35250722f.css","/component---src-pages-about-js-db2a035c2ab06e727818.js"],"pages-manifest":["/pages-manifest-12439998573dd1802510.js"]};/*]]>*/</script><script src="/component---src-templates-post-js-d1383df754ba37f756dc.js" async=""></script><script src="/0-0ff5f0f1eb7792733837.js" async=""></script><script src="/app-1443edc735991be4614a.js" async=""></script><script src="/webpack-runtime-5999ca5f73382b369690.js" async=""></script></body></html>