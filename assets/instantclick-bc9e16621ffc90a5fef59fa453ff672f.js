var InstantClick=function(e,t){function n(e){var t=e.indexOf("#");return 0>t?e:e.substr(0,t)}function i(e){for(;"A"!=e.nodeName;)e=e.parentNode;return e}function r(e,t){for(var n=0;n<N[e].length;n++)N[e][n](t)}function a(t,i,a,o){if(e.title=t,e.documentElement.replaceChild(i,e.body),a){if(history.pushState(null,null,a),t=a.indexOf("#"),t=t>-1&&e.getElementById(a.substr(t+1)),i=0,t)for(;t.offsetParent;)i+=t.offsetTop,t=t.offsetParent;scrollTo(0,i),p=n(a)}else scrollTo(0,o);h(),D.done(),r("change",!1)}function o(e){u(i(e.target).href)}function s(e){e=i(e.target),e.addEventListener("mouseout",f),E?(g=e.href,y=setTimeout(u,E)):u(e.href)}function l(e){e=i(e.target),T?e.removeEventListener("mousedown",o):e.removeEventListener("mouseover",s),u(e.href)}function d(e){1<e.which||e.metaKey||e.ctrlKey||(e.preventDefault(),m(i(e.target).href))}function f(){y?(clearTimeout(y),y=!1):H&&!O&&(v.abort(),O=H=!1)}function c(){if(!(4>v.readyState)&&0!=v.status){if(Y.ready=+new Date-Y.start,r("receive"),v.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=e.implementation.createHTMLDocument("");t.documentElement.innerHTML=v.responseText,x=t.title,C=t.body;var i=n(A);k[i]={body:C,title:x,scrollY:i in k?k[i].scrollY:0};for(var a,t=t.head.children,i=0,o=t.length-1;o>=0;o--)if(a=t[o],a.hasAttribute("data-instant-track")){a=a.getAttribute("href")||a.getAttribute("src")||a.innerHTML;for(var s=B.length-1;s>=0;s--)B[s]==a&&i++}i!=B.length&&(M=!0)}else M=!0;O&&(O=!1,m(A))}}function h(i){for(var r,a=e.getElementsByTagName("a"),f=t.protocol+"//"+t.host,c=a.length-1;c>=0;c--){r=a[c];var h;if(!((h=r.target)||(h=r.hasAttribute("download"))||(h=0!=r.href.indexOf(f+"/"))||(h=-1<r.href.indexOf("#")&&n(r.href)==p)))if(b){e:{h=r;do{if(!h.hasAttribute)break;if(h.hasAttribute("data-no-instant"))break;if(h.hasAttribute("data-instant")){h=!0;break e}}while(h=h.parentNode);h=!1}h=!h}else e:{h=r;do{if(!h.hasAttribute)break;if(h.hasAttribute("data-instant"))break;if(h.hasAttribute("data-no-instant")){h=!0;break e}}while(h=h.parentNode);h=!1}h||(r.addEventListener("touchstart",l),T?r.addEventListener("mousedown",o):r.addEventListener("mouseover",s),r.addEventListener("click",d))}if(!i)for(i=e.body.getElementsByTagName("script"),c=0,j=i.length;c<j;c++)a=i[c],a.hasAttribute("data-no-instant")||(r=e.createElement("script"),a.src&&(r.src=a.src),a.innerHTML&&(r.innerHTML=a.innerHTML),f=a.parentNode,h=a.nextSibling,f.removeChild(a),f.insertBefore(r,h))}function u(e){(T||!("display"in Y&&100>+new Date-(Y.start+Y.display)))&&(y&&(clearTimeout(y),y=!1),e||(e=g),(!H||e!=A&&!O)&&(H=!0,O=!1,A=e,M=C=!1,Y={start:+new Date},r("fetch"),v.open("GET",e),v.send()))}function m(e){"display"in Y||(Y.display=+new Date-Y.start),y?A&&A!=e?t.href=e:(u(e),D.start(0,!0),r("wait"),O=!0):!H||O?t.href=e:M?t.href=A:C?(k[p].scrollY=pageYOffset,O=H=!1,a(x,C,A)):(D.start(0,!0),r("wait"),O=!0)}var p,g,y,v,b,T,E,w=navigator.userAgent,L="createTouch"in e,k={},A=!1,x=!1,M=!1,C=!1,Y={},H=!1,O=!1,B=[],N={fetch:[],receive:[],wait:[],change:[]},D=function(){function t(t,a){f=t,e.getElementById(s.id)&&e.body.removeChild(s),s.style.opacity="1",e.getElementById(s.id)&&e.body.removeChild(s),r(),a&&setTimeout(n,0),clearTimeout(c),c=setTimeout(i,500)}function n(){f=10,r()}function i(){f+=1+2*Math.random(),f>=98?f=98:c=setTimeout(i,500),r()}function r(){l.style[d]="translate("+f+"%)",e.getElementById(s.id)||e.body.appendChild(s)}function a(){e.getElementById(s.id)?(clearTimeout(c),f=100,r(),s.style.opacity="0"):(t(100==f?0:f),setTimeout(a,0))}function o(){s.style.left=pageXOffset+"px",s.style.width=innerWidth+"px",s.style.top=pageYOffset+"px";var e="orientation"in window&&90==Math.abs(orientation);s.style[d]="scaleY("+innerWidth/screen[e?"height":"width"]*2+")"}var s,l,d,f,c;return{init:function(){s=e.createElement("div"),s.id="instantclick",l=e.createElement("div"),l.id="instantclick-bar",l.className="instantclick-bar",s.appendChild(l);var t=["Webkit","Moz","O"];if(d="transform",!(d in l.style))for(var n=0;3>n;n++)t[n]+"Transform"in l.style&&(d=t[n]+"Transform");var i="transition";if(!(i in l.style))for(n=0;3>n;n++)t[n]+"Transition"in l.style&&(i="-"+t[n].toLowerCase()+"-"+i);t=e.createElement("style"),t.innerHTML="#instantclick{position:"+(L?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+i+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+i+":all .25s}",e.head.appendChild(t),L&&(o(),addEventListener("resize",o),addEventListener("scroll",o))},start:t,done:a}}(),I="pushState"in history&&(!w.match("Android")||w.match("Chrome/"))&&"file:"!=t.protocol;return{supported:I,init:function(){if(!p)if(I){for(var i=arguments.length-1;i>=0;i--){var o=arguments[i];!0===o?b=!0:"mousedown"==o?T=!0:"number"==typeof o&&(E=o)}p=n(t.href),k[p]={body:e.body,title:e.title,scrollY:pageYOffset};for(var s,o=e.head.children,i=o.length-1;i>=0;i--)s=o[i],s.hasAttribute("data-instant-track")&&(s=s.getAttribute("href")||s.getAttribute("src")||s.innerHTML,B.push(s));v=new XMLHttpRequest,v.addEventListener("readystatechange",c),h(!0),D.init(),r("change",!0),addEventListener("popstate",function(){var e=n(t.href);e!=p&&(e in k?(k[p].scrollY=pageYOffset,p=e,a(k[e].title,k[e].body,!1,k[e].scrollY)):t.href=t.href)})}else r("change",!0)},on:function(e,t){N[e].push(t)}}}(document,location);